<div class="container">
    <h2 class="title has-text-centered">Student Profile for {{ student.name }}</h2>
    <h3 class="subtitle">Student Number: {{ student.reg_no }}</h3>

    {% if exam_results %}
        {% set current_year = None %}
        {% set current_semester = None %}
        {% for result in exam_results %}
            {% if result.acYear != current_year or result.semester != current_semester %}
                {% if current_year is not none %}
                    </tbody>
                    </table>
                {% endif %}
                <h4 class="title is-4">Academic Year: {{ result.acYear }} | Semester: {{ result.semester }}</h4>
                <table class="table is-bordered is-striped is-fullwidth">
                    <thead>
                        <tr>
                            <th>Course Code</th>
                            <th>Degree Code</th>
                            <th>Level</th>
                            <th>CA Marks</th>
                            <th>TH Marks</th>
                            <th>PR Marks</th>
                            <th>Total Marks</th>
                            <th>CA Grade</th>
                            <th>TH Grade</th>
                            <th>PR Grade</th>
                            <th>Final Grade</th>
                            <th>Comments</th>
                        </tr>
                    </thead>
                    <tbody>
            {% set current_year = result.acYear %}
            {% set current_semester = result.semester %}
            {% endif %}
            <tr>
                <td>{{ result.courseCode }}</td>
                <td>{{ result.degreeCode }}</td>
                <td>{{ result.level }}</td>
                <td>{{ result.ca_marks }}</td>
                <td>{{ result.th_marks }}</td>
                <td>{{ result.pr_marks }}</td>
                <td>{{ result.total_marks }}</td>
                <td>{{ result.ca_grade }}</td>
                <td>{{ result.th_grade }}</td>
                <td>{{ result.pr_grade }}</td>
                <td>{{ result.grade }}</td>
                <td>
                    {% if result.grade == 'Inc' or 'Medical' in result.grd_comments %}
                        {{ result.grd_comments }}
                    {% else %}
                        N/A
                    {% endif %}
                </td>
            </tr>
        {% endfor %}
        </tbody>
        </table>
    {% else %}
        <p>No results found for this student.</p>
    {% endif %}
</div>

